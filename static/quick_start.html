<!DOCTYPE html>
    <html>
    <head>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <title>Quick Start with AMulti-GCLSTM</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        <link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
    </head>
    <body>
        <link rel="stylesheet" href="./static/css/misty.css" type="text/css"/>
<h2 id="quick-start-with-amulti-gclstm">Quick Start with AMulti-GCLSTM</h2>
<p>Following shows a quick start of AMulti-GCLSTM using data loader from Dataset.</p>
<pre><code class="language-python"><div><span class="hljs-keyword">from</span> DataSet.node_traffic_loader <span class="hljs-keyword">import</span> NodeTrafficLoader
<span class="hljs-keyword">from</span> Model.AMulti_GCLSTM <span class="hljs-keyword">import</span> AMulti_GCLSTM
<span class="hljs-keyword">from</span> EvalClass.Accuracy <span class="hljs-keyword">import</span> Accuracy

<span class="hljs-comment"># Get data loader</span>
data_loader = NodeTrafficLoader()

<span class="hljs-comment"># Initialize an object of Amulti-GCLSTM</span>
AMulti_GCLSTM_Obj = AMulti_GCLSTM(num_node=data_loader.station_number,
                                  GCN_K=[<span class="hljs-number">1</span>],
                                  GCN_layers=[<span class="hljs-number">1</span>],
                                  num_graph=data_loader.LM.shape[<span class="hljs-number">0</span>],
                                  external_dim=data_loader.external_dim,
                                  GCLSTM_layers=<span class="hljs-number">1</span>,
                                  gal_units=<span class="hljs-number">32</span>,
                                  gal_num_heads=<span class="hljs-number">2</span>,
                                  T=<span class="hljs-number">6</span>,
                                  num_filter_conv1x1=<span class="hljs-number">32</span>,
                                  num_hidden_units=<span class="hljs-number">32</span>,
                                  lr=<span class="hljs-number">5e-4</span>,
                                  code_version=<span class="hljs-string">'DebugV0'</span>,
                                  GPU_DEVICE=<span class="hljs-string">'0'</span>,
                                  model_dir=<span class="hljs-string">'./model_dir/'</span>)
<span class="hljs-comment"># Build graphs</span>
AMulti_GCLSTM_Obj.build()

<span class="hljs-comment"># Train the model</span>
AMulti_GCLSTM_Obj.fit(input=data_loader.train_x,
                      laplace_matrix=data_loader.LM,
                      target=data_loader.train_y,
                      external_feature=data_loader.train_ef,
                      batch_size=<span class="hljs-number">64</span>,
                      max_epoch=<span class="hljs-number">5000</span>,
                      early_stop_method=<span class="hljs-string">'t-test'</span>,
                      early_stop_length=<span class="hljs-number">50</span>,
                      early_stop_patience=<span class="hljs-number">0.1</span>)

<span class="hljs-comment"># Evaluate on test data</span>
test_rmse = AMulti_GCLSTM_Obj.evaluate(input=data_loader.test_x,
                                       laplace_matrix=data_loader.LM,
                                       target=data_loader.test_y,
                                       external_feature=data_loader.test_ef,
                                       metrics=[Accuracy.RMSE],
                                       threshold=<span class="hljs-number">0</span>)
print(<span class="hljs-string">'Test result'</span>, test_rmse)
</div></code></pre>
<hr>
<p><u><a href="../index.html">Back To HomePage</a></u></p>

    </body>
    </html>